/**
 *
 * Punch BOOT
 *
 * Copyright (C) 2020 Jonas Blixt <jonpe960@gmail.com>
 *
 * SPDX-License-Identifier: BSD-3-Clause
 *
 */

#include <stdio.h>
#include <pb/asn1.h>
#include <pb/assert.h>
#include <string.h>
#include "test.h"

const uint8_t secp256[] =
{
0x30,
    0x45,
    0x2,
    0x20,
    0x75,
    0xb,
    0x8b,
    0xbe,
    0xee,
    0x30,
    0x7a,
    0xcd,
    0xf5,
    0x1e,
    0x7d,
    0xcb,
    0x14,
    0x8a,
    0xb7,
    0x2a,
    0xa2,
    0xef,
    0xff,
    0xa6,
    0xa2,
    0x9,
    0x48,
    0xa6,
    0x6e,
    0xb7,
    0x1c,
    0x8,
    0x4b,
    0xb9,
    0x57,
    0xab,
    0x2,
    0x21,
    0x0,
    0x8b,
    0x27,
    0x9e,
    0x4d,
    0x7,
    0xf,
    0x5c,
    0x1c,
    0xec,
    0xda,
    0xc5,
    0x9a,
    0x33,
    0x80,
    0xdb,
    0x43,
    0x38,
    0x23,
    0xcf,
    0x91,
    0x37,
    0x5b,
    0x7d,
    0xfe,
    0x86,
    0x62,
    0x75,
    0x95,
    0xa7,
    0xaa,
    0x26,
    0x9b,
};

const uint8_t secp384[] =
{
0x30,
0x66,
0x2,
0x31,
0x0,
0xb0,
0x53,
0xae,
0x5f,
0x52,
0x67,
0xb0,
0xbd,
0x3a,
0x36,
0x5c,
0xc5,
0x4f,
0x6,
0x6c,
0xe2,
0xf1,
0x63,
0xf4,
0x45,
0x9f,
0xaa,
0x30,
0xe4,
0x51,
0x4,
0x3,
0xef,
0x9e,
0x67,
0x2f,
0xf4,
0x92,
0xf6,
0x56,
0xea,
0x2b,
0x50,
0x4,
0xcb,
0x89,
0x73,
0x58,
0x16,
0xdc,
0x1,
0xa,
0x78,
0x2,
0x31,
0x0,
0xc7,
0x26,
0x8e,
0xd6,
0x76,
0x29,
0xb6,
0x9,
0xde,
0xe5,
0x11,
0x97,
0xfa,
0x54,
0x9b,
0x98,
0x60,
0xbf,
0x2e,
0x82,
0x94,
0xea,
0x6f,
0xa3,
0x1,
0xb,
0x93,
0xd7,
0xf5,
0xe3,
0xf1,
0x93,
0xbb,
0x60,
0x6,
0x91,
0xcc,
0x34,
0x1a,
0xa4,
0xbc,
0x68,
0x0,
0xa0,
0x39,
0xbc,
0x6e,
0xeb,
};

const uint8_t secp521[] =
{
0x30,
0x81,
0x88,
0x2,
0x42,
0x1,
0x3b,
0x73,
0x7f,
0x69,
0xb2,
0x39,
0x14,
0xef,
0x33,
0x1a,
0x2b,
0xad,
0x1a,
0xae,
0x88,
0xe6,
0xd8,
0xd3,
0xfc,
0x54,
0x25,
0xa3,
0x95,
0xe9,
0xb0,
0xca,
0x1d,
0x70,
0x15,
0xa4,
0x5e,
0x81,
0xc8,
0xd5,
0xd9,
0x6f,
0x8a,
0xd2,
0x80,
0x2e,
0xda,
0x4,
0x76,
0x37,
0x89,
0xf3,
0xcb,
0xbf,
0x5c,
0x52,
0x40,
0x7e,
0xd,
0x67,
0xfa,
0x6a,
0xea,
0x2,
0x1a,
0x2b,
0xe5,
0x5b,
0x5b,
0x58,
0x99,
0x2,
0x42,
0x1,
0x7a,
0x1a,
0x75,
0x6e,
0xf1,
0x96,
0x7,
0x7f,
0x35,
0x11,
0x74,
0x5,
0xc4,
0x22,
0xb6,
0xad,
0x3e,
0xbb,
0x26,
0xc0,
0x69,
0xd0,
0x2d,
0x79,
0x59,
0x47,
0xbf,
0x1a,
0x4f,
0xf9,
0x60,
0x3,
0x5e,
0xf9,
0xd0,
0xc4,
0xc2,
0x51,
0xd7,
0x6a,
0x5,
0x76,
0xe5,
0x0,
0x62,
0xdb,
0x7f,
0xb6,
0xe6,
0xa,
0xcd,
0x48,
0xc9,
0x88,
0xa,
0x55,
0x3e,
0x60,
0x42,
0xd6,
0x8a,
0x99,
0x37,
0xee,
0xe4,
};

void test_main(void)

{
    int rc;
    uint8_t *r = NULL;
    uint8_t *s = NULL;

    rc = pb_asn1_ecsig_to_rs(secp256, BPAK_SIGN_PRIME256v1, &r, &s);

    assert(rc == PB_OK);
    printf("r = %p, s = %p\n\r", r, s);
    assert(r);
    assert(s);

    rc = pb_asn1_ecsig_to_rs(secp384, BPAK_SIGN_SECP384r1, &r, &s);

    assert(rc == PB_OK);
    printf("r = %p, s = %p\n\r", r, s);
    assert(r);
    assert(s);

    rc = pb_asn1_ecsig_to_rs(secp521, BPAK_SIGN_SECP521r1, &r, &s);

    assert(rc == PB_OK);
    printf("r = %p, s = %p\n\r", r, s);
    assert(r);
    assert(s);
}
